function createAnimatingBar(){$.post("/compare/search",{company:"",selections:JSON.stringify([selection])},function(e){if(e.rows.length>0){var t=new DataProcessor;barData=t.createDataForGroupedGraph(e.rows),unit=e.rows[0].units;var a=-(1/0);e.rows.forEach(function(e){a=+e.value>a?+e.value:a}),$("#animating-bar").append('<h4 class="title">'+selection.subCategory+", "+selection.description+"</h4>"),$("#animating-bar").append('<h5 class="subTitle">'+selection.section+", "+selection.subCategory+"</h5>");var e=[];for(var o in barData.data[curDataIndex])"edb"!==o&&e.push({category:o,value:barData.data[curDataIndex][o]});SingleBarModule.createBarGraph("#animating-bar",a,0,e,barData.data[curDataIndex].edb,unit),curDataIndex++,d3.interval(function(){var e=[];for(var t in barData.data[curDataIndex])"edb"!==t&&e.push({category:t,value:barData.data[curDataIndex][t]});SingleBarModule.createBarGraph("#animating-bar",a,0,e,barData.data[curDataIndex].edb,unit),curDataIndex=curDataIndex+1>=barData.data.length?0:curDataIndex+1},2e3)}else console.log("No results")})}function insertDataTable(e){console.log("Inserting table"),$("#results-table").append("<caption>"+e[0].description+"</caption>");var t=!1;null!==e[0].obs_yr?(console.log("Observed"),t=!0):null!==e[0].fcast_yr&&console.log("Forecast");var a=null,o=null;t?(a=e.reduce(function(e,t){return e.disc_yr<t.disc_yr?e:t}).obs_yr,o=e.reduce(function(e,t){return e.disc_yr>t.disc_yr?e:t}).obs_yr):(a=e.reduce(function(e,t){return e.fcast_yr<t.fcast_yr?e:t}).fcast_yr,o=e.reduce(function(e,t){return e.fcast_yr>t.fcast_yr?e:t}).fcast_yr),console.log("Min "+a+" Max "+o);for(var n="",r=a;r<=o;r++)n+="<th>"+r+"</th>";$("#results-table").append('<tr id="head-row"> <th>EDB</th>'+n+"</tr>");for(var s=[],c=0,i=[],r=0;r<e.length;r++)if(!s.includes(e[r].edb)){s.push(e[r].edb);for(var l="<tr id=row"+r+"><th>"+e[r].edb+"</th>",u=a;u<=o;u++)for(var d=0;d<e.length;d++)e[d].edb===e[r].edb&&(t?e[d].disc_yr:e[d].fcast_yr)===u&&(l+="<th id='t"+c+"'>"+e[d].value+"</th>",i.push({id:"#t"+c,value:e[d].value}),c++);$("#results-table").append(l+"</tr>"),$("#row"+r).click(function(e){showBarWithRowElem(this.id)})}for(var o=-(1/0),r=0;r<i.length;r++)+i[r].value>o&&(o=+i[r].value),$(i[r].id).css({background:"-webkit-gradient(linear, left top, right top, color-stop("+i[r].value+"%,#F00), color-stop("+i[r].value+"%,#FFF))"});maxTableValue=o}function showBarWithRowElem(e){var t=[];$("#results-table").find("tr").removeClass("row-selected"),$("#"+e).addClass("row-selected"),$("#head-row").find("th").each(function(e,a){0!=e&&t.push({category:$(a).text(),value:0})});var a="";$("#"+e).find("th").each(function(e,o){0!=e?t[e-1].value=$(o).text():a=t[e].value=$(o).text()}),SingleBarModule.createBarGraph("#graph-div",maxTableValue,t)}function insertCompanies(){$.get("/sections/company",function(e){e.companies.length>0&&$("#company-select").html("<option selected>"+e.companies[0]+"</option>");for(var t=1;t<e.companies.length;t++)$("#company-select").append("<option>"+e.companies[t]+"</option>");$(".selectpicker").selectpicker("refresh")})}var section="",category="",subcategory="",company="",description="",descriptionExists=!1,subExists=!1;$(document).ready(function(){$(".nav-link").removeClass("active"),$("#data-link").addClass("active"),insertCompanies(),$("#section-select").on("change",function(){section=$(this).find("option:selected").text(),$.post("/sections/s",{selected:section},function(e){e.categories.length>0&&$("#category-select").html("");for(var t=0;t<e.categories.length;t++)$("#category-select").append("<option>"+e.categories[t]+"</option>");$(".selectpicker").selectpicker("refresh")})}),$("#category-select").on("change",function(){category=$(this).find("option:selected").text(),$.post("/sections/sc",{category:category,section:section},function(e){if(!(e.subCategories.length>0&&null!==e.subCategories[0]))return void(subExists=!1);subExists=!0,$("#subsection-select").html("");for(var t=0;t<e.subCategories.length;t++)$("#subsection-select").append("<option>"+e.subCategories[t]+"</option>");$(".selectpicker").selectpicker("refresh")})}),$("#subsection-select").on("change",function(){subcategory=$(this).find("option:selected").text(),$.post("/sections/desc",{category:category,section:section,subCategory:subcategory},function(e){if(!(e.descriptions.length>0&&null!==e.descriptions[0]))return void(descriptionExists=!1);descriptionExists=!0,$("#description-select").html("");for(var t=0;t<e.descriptions.length;t++)$("#description-select").append("<option>"+e.descriptions[t]+"</option>");$(".selectpicker").selectpicker("refresh")})}),$("#description-select").on("change",function(){description=$(this).find("option:selected").text()}),$("#company-select").on("change",function(){company=$(this).find("option:selected").text()}),$("#search-btn").click(function(){return""===section?void $("#error").html("Section not selected"):""===category?void $("#error").html("Category not selected"):""===subcategory&&subExists?void $("#error").html("Sub category not selected"):void $.post("/sections/search",{section:section,category:category,subCategory:subcategory,company:company,description:description},function(e){e.rows.length>0?insertDataTable(e.rows):console.log("No results")})}),createAnimatingBar()});var selection={section:"1(i): Expenditure metrics",category:"Operational expenditure",subCategory:"Network",description:"Expenditure per average no. of ICPs ($/ICP)",id:0},curDataIndex=0,barData,unit,maxTableValue=0;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImNyZWF0ZUFuaW1hdGluZ0JhciIsIiQiLCJwb3N0IiwiY29tcGFueSIsInNlbGVjdGlvbnMiLCJKU09OIiwic3RyaW5naWZ5Iiwic2VsZWN0aW9uIiwiZGF0YSIsInJvd3MiLCJsZW5ndGgiLCJkcCIsIkRhdGFQcm9jZXNzb3IiLCJiYXJEYXRhIiwiY3JlYXRlRGF0YUZvckdyb3VwZWRHcmFwaCIsInVuaXQiLCJ1bml0cyIsIm1heCIsIkluZmluaXR5IiwiZm9yRWFjaCIsInIiLCJ2YWx1ZSIsImFwcGVuZCIsInN1YkNhdGVnb3J5IiwiZGVzY3JpcHRpb24iLCJzZWN0aW9uIiwicHJvcGVydHlOYW1lIiwiY3VyRGF0YUluZGV4IiwicHVzaCIsImNhdGVnb3J5IiwiU2luZ2xlQmFyTW9kdWxlIiwiY3JlYXRlQmFyR3JhcGgiLCJlZGIiLCJkMyIsImludGVydmFsIiwiY29uc29sZSIsImxvZyIsImluc2VydERhdGFUYWJsZSIsIm9ic2VydmVyZCIsIm9ic195ciIsImZjYXN0X3lyIiwibWluIiwicmVkdWNlIiwicHJldiIsImN1cnIiLCJkaXNjX3lyIiwieWVhcnMiLCJpIiwiZG9uZSIsImNlbGxDb3VudCIsImNlbGxWYWx1ZXMiLCJpbmNsdWRlcyIsInJvdyIsImN1ciIsImoiLCJpZCIsImNsaWNrIiwiZXZlbnQiLCJzaG93QmFyV2l0aFJvd0VsZW0iLCJ0aGlzIiwiY3NzIiwiYmFja2dyb3VuZCIsIm1heFRhYmxlVmFsdWUiLCJyb3dJRCIsImZpbmQiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiZWFjaCIsImluZGV4IiwiZWxlbWVudCIsInRleHQiLCJ0aXRsZSIsImluc2VydENvbXBhbmllcyIsImdldCIsImNvbXBhbmllcyIsImh0bWwiLCJzZWxlY3RwaWNrZXIiLCJzdWJjYXRlZ29yeSIsImRlc2NyaXB0aW9uRXhpc3RzIiwic3ViRXhpc3RzIiwiZG9jdW1lbnQiLCJyZWFkeSIsIm9uIiwic2VsZWN0ZWQiLCJj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QUEsVUFBQTBFLEtBQUEsd0JBRUEsS0FBQTlDLGFBQ0E1QixHQUFBLFVBQUEwRSxLQUFBLHlCQUVBLEtBQUFFLGFBQUFFLGNBQ0E5RSxHQUFBLFVBQUEwRSxLQUFBLGlDQUtBMUUsR0FBQUMsS0FBQSxvQkFBQXVCLFFBQUFBLFFBQUFJLFNBQUFBLFNBQUFOLFlBQUFzRCxZQUFBMUUsUUFBQUEsUUFBQXFCLFlBQUFBLGFBQUEsU0FBQWhCLEdBQ0FBLEVBQUFDLEtBQUFDLE9BQUEsRUFDQTJCLGdCQUFBN0IsRUFBQUMsTUFFQTBCLFFBQUFDLElBQUEsa0JBS0FwQyxzQkFHQSxJQUFBTyxZQUFBa0IsUUFBQSw0QkFBQUksU0FBQSwwQkFBQU4sWUFBQSxVQUFBQyxZQUFBLDhDQUFBK0IsR0FBQSxHQUVBNUIsYUFBQSxFQUNBZCxRQUNBRSxLQTJDQStDLGNBQUEiLCJmaWxlIjoiaW5kZXgubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgTmlja3kgb24gMTUvMDEvMjAxNy5cclxuICovXHJcblxyXG5cclxuLy8gSG9sZCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHNlY3Rpb25zXHJcbnZhciBzZWN0aW9uID0gXCJcIjtcclxudmFyIGNhdGVnb3J5ID0gXCJcIjtcclxudmFyIHN1YmNhdGVnb3J5ID0gXCJcIjtcclxudmFyIGNvbXBhbnkgPSBcIlwiO1xyXG52YXIgZGVzY3JpcHRpb24gPSBcIlwiO1xyXG5cclxudmFyIGRlc2NyaXB0aW9uRXhpc3RzID0gZmFsc2U7XHJcbnZhciBzdWJFeGlzdHMgPSBmYWxzZTtcclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KCBmdW5jdGlvbigpIHtcclxuICAgIC8vIEhpZ2hsaWdodCB0aGUgc2VsZWN0ZWQgbGlua1xyXG4gICAgJChcIi5uYXYtbGlua1wiKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAkKFwiI2RhdGEtbGlua1wiKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgLy8gUXVlcmllcyBEQiBhbmQgaW5zZXJ0cyBvcHRpb25zIGluIHNlbGVjdGlvbiBkcm9wZG93blxyXG4gICAgaW5zZXJ0Q29tcGFuaWVzKCk7XHJcblxyXG4gICAgLy8gQWRkIGxpc3RlbmVycyB0byBzZWN0aW9uIHNlbGVjdCBjYWxsZWQgd2hlbiBzZWN0aW9uIGlzIHNlbGVjdGVkXHJcbiAgICAkKCcjc2VjdGlvbi1zZWxlY3QnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgLy8gU2V0IHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgc2VjdGlvblxyXG4gICAgICAgIHNlY3Rpb24gPSAkKHRoaXMpLmZpbmQoXCJvcHRpb246c2VsZWN0ZWRcIikudGV4dCgpO1xyXG5cclxuICAgICAgICAvLyBGaW5kIGFsbCB0aGUgY2F0ZWdvcmllcyBhc3NvY2lhdGVkIHdpdGggdGhpcyBzZWN0aW9uXHJcbiAgICAgICAgJC5wb3N0KFwiL3NlY3Rpb25zL3NcIix7c2VsZWN0ZWQgOiBzZWN0aW9uIH0sIGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICBpZihkYXRhLmNhdGVnb3JpZXMubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgICAgICAkKCcjY2F0ZWdvcnktc2VsZWN0JykuaHRtbCgnJyk7IC8vIEVtcHR5IHRlbXAgb3B0aW9uc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgdGhlIG9wdGlvbnMgdG8gdGhlIGRyb3AgZG93blxyXG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgZGF0YS5jYXRlZ29yaWVzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICQoJyNjYXRlZ29yeS1zZWxlY3QnKS5hcHBlbmQoJzxvcHRpb24+JyArIGRhdGEuY2F0ZWdvcmllc1tpXSArICc8L29wdGlvbj4nKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gUmVmcmVzaCBhbGwgZHJvcCBkb3duc1xyXG4gICAgICAgICAgICAkKFwiLnNlbGVjdHBpY2tlclwiKS5zZWxlY3RwaWNrZXIoJ3JlZnJlc2gnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvLyBsaXN0ZW5lciBmb3IgY2F0ZWdvcnkgY2hhbmdlXHJcbiAgICAkKCcjY2F0ZWdvcnktc2VsZWN0Jykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIC8vIFNldCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGNhdGVnb3J5XHJcbiAgICAgICAgY2F0ZWdvcnkgPSAkKHRoaXMpLmZpbmQoXCJvcHRpb246c2VsZWN0ZWRcIikudGV4dCgpO1xyXG5cclxuICAgICAgICAvL1RPRE8gbWlnaHQgaGF2ZSB0byBtYWtlIHN1cmUgdGhlIHNlY3Rpb24gaXMgYWxzbyB0aGUgc2FtZVxyXG5cclxuICAgICAgICAvLyBGaW5kIGFsbCBzdWIgY2F0ZWdvcmllcyBmb3IgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBjYXRlZ29yeVxyXG4gICAgICAgICQucG9zdChcIi9zZWN0aW9ucy9zY1wiLHtjYXRlZ29yeSA6IGNhdGVnb3J5LHNlY3Rpb24gOiBzZWN0aW9ufSwgZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgIGlmKGRhdGEuc3ViQ2F0ZWdvcmllcy5sZW5ndGggPiAwICYmICBkYXRhLnN1YkNhdGVnb3JpZXNbMF0gIT09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgc3ViRXhpc3RzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICQoJyNzdWJzZWN0aW9uLXNlbGVjdCcpLmh0bWwoJycpOyAvLyBFbXB0eSB0ZW1wIG9wdGlvbnNcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHN1YkV4aXN0cyA9IGZhbHNlOyAvL1RPRE8gQ2hlY2sgZm9yIG5vIGRhdGEgd2hlbiBzZWFyY2hpbmcgc2VydmVyIHNpZGUgb3IgcmVtb3ZlIE5vIGRhdGEgb3B0aW9uXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEFkZCBzdWIgc2VjdGlvbiBvcHRpb25zXHJcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBkYXRhLnN1YkNhdGVnb3JpZXMubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgJCgnI3N1YnNlY3Rpb24tc2VsZWN0JykuYXBwZW5kKCc8b3B0aW9uPicgKyBkYXRhLnN1YkNhdGVnb3JpZXNbaV0gKyAnPC9vcHRpb24+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJChcIi5zZWxlY3RwaWNrZXJcIikuc2VsZWN0cGlja2VyKCdyZWZyZXNoJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIC8vIFN1YiBDYXRlZ29yeSBzZWxlY3QgbGlzdGVuZXJcclxuICAgICQoJyNzdWJzZWN0aW9uLXNlbGVjdCcpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIC8vIFNldCB0aGUgc3ViIGNhdGVnb3J5XHJcbiAgICAgICAgc3ViY2F0ZWdvcnkgPSAkKHRoaXMpLmZpbmQoXCJvcHRpb246c2VsZWN0ZWRcIikudGV4dCgpO1xyXG5cclxuXHJcbiAgICAgICAgLy8gRmluZCBhbGwgZGVzY3JpcHRpb25zIGZvciB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHN1YiBjYXRlZ29yeVxyXG4gICAgICAgICQucG9zdChcIi9zZWN0aW9ucy9kZXNjXCIse2NhdGVnb3J5IDogY2F0ZWdvcnksc2VjdGlvbiA6IHNlY3Rpb24sIHN1YkNhdGVnb3J5IDogc3ViY2F0ZWdvcnl9LCBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgaWYoZGF0YS5kZXNjcmlwdGlvbnMubGVuZ3RoID4gMCAmJiAgZGF0YS5kZXNjcmlwdGlvbnNbMF0gIT09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb25FeGlzdHMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJCgnI2Rlc2NyaXB0aW9uLXNlbGVjdCcpLmh0bWwoJycpOyAvLyBFbXB0eSB0ZW1wIG9wdGlvbnNcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uRXhpc3RzID0gZmFsc2U7IC8vVE9ETyBDaGVjayBmb3Igbm8gZGF0YSB3aGVuIHNlYXJjaGluZyBzZXJ2ZXIgc2lkZSBvciByZW1vdmUgTm8gZGF0YSBvcHRpb25cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQWRkIHN1YiBzZWN0aW9uIG9wdGlvbnNcclxuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGRhdGEuZGVzY3JpcHRpb25zLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICQoJyNkZXNjcmlwdGlvbi1zZWxlY3QnKS5hcHBlbmQoJzxvcHRpb24+JyArIGRhdGEuZGVzY3JpcHRpb25zW2ldICsgJzwvb3B0aW9uPicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICQoXCIuc2VsZWN0cGlja2VyXCIpLnNlbGVjdHBpY2tlcigncmVmcmVzaCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgICQoJyNkZXNjcmlwdGlvbi1zZWxlY3QnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAvLyBTZXQgdGhlIGRlc2NyaXB0aW9uXHJcbiAgICAgICAgZGVzY3JpcHRpb24gPSAkKHRoaXMpLmZpbmQoXCJvcHRpb246c2VsZWN0ZWRcIikudGV4dCgpO1xyXG4gICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICAkKCcjY29tcGFueS1zZWxlY3QnKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAvLyBzZXQgdGhlIHNlbGVjdGVkIGNvbXBhbnlcclxuICAgICAgICBjb21wYW55ID0gJCh0aGlzKS5maW5kKFwib3B0aW9uOnNlbGVjdGVkXCIpLnRleHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENsaWNrZWQgdGhlIHNlYXJjaCBidXR0b25cclxuICAgICQoIFwiI3NlYXJjaC1idG5cIiApLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAvL1RPRE8gRmlyc3QgY2hlY2sgaWYgYW55IHZhbHVlcyBudWxsXHJcbiAgICAgICAgaWYoc2VjdGlvbiA9PT0gXCJcIil7XHJcbiAgICAgICAgICAgICQoJyNlcnJvcicpLmh0bWwoXCJTZWN0aW9uIG5vdCBzZWxlY3RlZFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSBpZihjYXRlZ29yeSA9PT0gXCJcIil7XHJcbiAgICAgICAgICAgICQoJyNlcnJvcicpLmh0bWwoXCJDYXRlZ29yeSBub3Qgc2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2UgaWYoc3ViY2F0ZWdvcnkgPT09IFwiXCIgJiYgc3ViRXhpc3RzKXtcclxuICAgICAgICAgICAgJCgnI2Vycm9yJykuaHRtbChcIlN1YiBjYXRlZ29yeSBub3Qgc2VsZWN0ZWRcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNlbmQgY2F0ZWdvcnksIHNlY3Rpb24sIHN1YiBjYXRlZ29yeSBhbmQgY29tcGFueVxyXG4gICAgICAgICQucG9zdChcIi9zZWN0aW9ucy9zZWFyY2hcIix7c2VjdGlvbiA6IHNlY3Rpb24sIGNhdGVnb3J5IDogY2F0ZWdvcnksIHN1YkNhdGVnb3J5IDogc3ViY2F0ZWdvcnksIGNvbXBhbnkgOiBjb21wYW55LCBkZXNjcmlwdGlvbiA6IGRlc2NyaXB0aW9ufSwgZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgIGlmKGRhdGEucm93cy5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgICAgIGluc2VydERhdGFUYWJsZShkYXRhLnJvd3MpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJObyByZXN1bHRzXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjcmVhdGVBbmltYXRpbmdCYXIoKTtcclxufSk7XHJcblxyXG52YXIgc2VsZWN0aW9uID0ge3NlY3Rpb24gOiBcIjEoaSk6IEV4cGVuZGl0dXJlIG1ldHJpY3NcIiwgY2F0ZWdvcnkgOiBcIk9wZXJhdGlvbmFsIGV4cGVuZGl0dXJlXCIsIHN1YkNhdGVnb3J5IDogXCJOZXR3b3JrXCIsIGRlc2NyaXB0aW9uIDogXCJFeHBlbmRpdHVyZSBwZXIgYXZlcmFnZSBuby4gb2YgSUNQcyAoJC9JQ1ApXCIsIGlkIDogMH07XHJcblxyXG52YXIgY3VyRGF0YUluZGV4ID0gMDtcclxudmFyIGJhckRhdGE7XHJcbnZhciB1bml0O1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQW5pbWF0aW5nQmFyKCl7XHJcbiAgICAgICAgLy8gU2VuZCBjYXRlZ29yeSwgc2VjdGlvbiwgc3ViIGNhdGVnb3J5IGFuZCBjb21wYW55XHJcbiAgICAgICAgJC5wb3N0KFwiL2NvbXBhcmUvc2VhcmNoXCIse2NvbXBhbnkgOiBcIlwiLCBzZWxlY3Rpb25zIDogSlNPTi5zdHJpbmdpZnkoW3NlbGVjdGlvbl0pfSwgZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgIGlmKGRhdGEucm93cy5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgICAgIHZhciBkcCA9IG5ldyBEYXRhUHJvY2Vzc29yKCk7XHJcbiAgICAgICAgICAgICAgICBiYXJEYXRhID0gZHAuY3JlYXRlRGF0YUZvckdyb3VwZWRHcmFwaChkYXRhLnJvd3MpO1xyXG4gICAgICAgICAgICAgICAgdW5pdCA9IGRhdGEucm93c1swXS51bml0c1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBtYXggPSAtSW5maW5pdHk7XHJcbiAgICAgICAgICAgICAgICBkYXRhLnJvd3MuZm9yRWFjaChmdW5jdGlvbihyKXtcclxuICAgICAgICAgICAgICAgICAgICBtYXggPSArci52YWx1ZSA+IG1heCA/ICtyLnZhbHVlIDogbWF4O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJCgnI2FuaW1hdGluZy1iYXInKS5hcHBlbmQoJzxoNCBjbGFzcz1cInRpdGxlXCI+Jysgc2VsZWN0aW9uLnN1YkNhdGVnb3J5ICsgJywgJyArIHNlbGVjdGlvbi5kZXNjcmlwdGlvbisnPC9oND4nKVxyXG4gICAgICAgICAgICAgICAgJCgnI2FuaW1hdGluZy1iYXInKS5hcHBlbmQoJzxoNSBjbGFzcz1cInN1YlRpdGxlXCI+Jysgc2VsZWN0aW9uLnNlY3Rpb24gKyAnLCAnICsgc2VsZWN0aW9uLnN1YkNhdGVnb3J5Kyc8L2g1PicpXHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgcHJvcGVydHlOYW1lIGluIGJhckRhdGEuZGF0YVtjdXJEYXRhSW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBpZihwcm9wZXJ0eU5hbWUgIT09IFwiZWRiXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKHtjYXRlZ29yeSA6IHByb3BlcnR5TmFtZSwgdmFsdWUgOiBiYXJEYXRhLmRhdGFbY3VyRGF0YUluZGV4XVtwcm9wZXJ0eU5hbWVdfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBTaW5nbGVCYXJNb2R1bGUuY3JlYXRlQmFyR3JhcGgoJyNhbmltYXRpbmctYmFyJyxtYXgsMCwgZGF0YSxiYXJEYXRhLmRhdGFbY3VyRGF0YUluZGV4XS5lZGIsdW5pdCk7XHJcbiAgICAgICAgICAgICAgICBjdXJEYXRhSW5kZXgrKztcclxuICAgICAgICAgICAgICAgICBkMy5pbnRlcnZhbChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgcHJvcGVydHlOYW1lIGluIGJhckRhdGEuZGF0YVtjdXJEYXRhSW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBpZihwcm9wZXJ0eU5hbWUgIT09IFwiZWRiXCIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKHtjYXRlZ29yeSA6IHByb3BlcnR5TmFtZSwgdmFsdWUgOiBiYXJEYXRhLmRhdGFbY3VyRGF0YUluZGV4XVtwcm9wZXJ0eU5hbWVdfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgU2luZ2xlQmFyTW9kdWxlLmNyZWF0ZUJhckdyYXBoKCcjYW5pbWF0aW5nLWJhcicsbWF4LDAsIGRhdGEsYmFyRGF0YS5kYXRhW2N1ckRhdGFJbmRleF0uZWRiLHVuaXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN1ckRhdGFJbmRleCA9IChjdXJEYXRhSW5kZXgrMSA+PSBiYXJEYXRhLmRhdGEubGVuZ3RoKSA/IDAgOiBjdXJEYXRhSW5kZXgrMTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJObyByZXN1bHRzXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5cclxuXHJcbnZhciBtYXhUYWJsZVZhbHVlID0gMDtcclxuXHJcbi8vIENyZWF0ZXMgYSB0YWJsZSB3aXRoIHRoZSBnaXZlbiByb3dzXHJcbmZ1bmN0aW9uIGluc2VydERhdGFUYWJsZShyb3dzKXtcclxuICAgIGNvbnNvbGUubG9nKFwiSW5zZXJ0aW5nIHRhYmxlXCIpO1xyXG5cclxuICAgIC8vIGZpcnN0IGNyZWF0ZSBjYXB0aW9uIHRpdGxlIHdpdGggZGVzY3JpcHRpb25cclxuICAgICQoJyNyZXN1bHRzLXRhYmxlJykuYXBwZW5kKCc8Y2FwdGlvbj4nICsgcm93c1swXS5kZXNjcmlwdGlvbiArICc8L2NhcHRpb24+Jyk7XHJcbiAgICAvL1RPRE8gY2hlY2sgaWYgZGlzY292ZXJlZCBvciBvYnNlcnZlZFxyXG4gICAgdmFyIG9ic2VydmVyZCA9IGZhbHNlO1xyXG5cclxuICAgIGlmKHJvd3NbMF0ub2JzX3lyICE9PSBudWxsKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIk9ic2VydmVkXCIpO1xyXG4gICAgICAgIG9ic2VydmVyZCA9IHRydWU7XHJcbiAgICB9IGVsc2UgaWYocm93c1swXS5mY2FzdF95ciAhPT0gbnVsbCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRm9yZWNhc3RcIik7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG1pbiA9IG51bGw7XHJcbiAgICB2YXIgbWF4ID0gbnVsbDtcclxuXHJcbiAgICBpZihvYnNlcnZlcmQpe1xyXG4gICAgICAgIC8vIEZpbmQgdGhlIG1pbiBhbmQgbWF4IHllYXJcclxuICAgICAgICBtaW4gPSByb3dzLnJlZHVjZShmdW5jdGlvbihwcmV2LCBjdXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcmV2LmRpc2NfeXIgPCBjdXJyLmRpc2NfeXIgPyBwcmV2IDogY3VycjtcclxuICAgICAgICB9KS5vYnNfeXI7XHJcblxyXG4gICAgICAgIG1heCA9IHJvd3MucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGN1cnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByZXYuZGlzY195ciA+IGN1cnIuZGlzY195ciA/IHByZXYgOiBjdXJyO1xyXG4gICAgICAgIH0pLm9ic195cjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmluZCB0aGUgbWluIGFuZCBtYXggeWVhclxyXG4gICAgICAgIG1pbiA9IHJvd3MucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGN1cnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByZXYuZmNhc3RfeXIgPCBjdXJyLmZjYXN0X3lyID8gcHJldiA6IGN1cnI7XHJcbiAgICAgICAgfSkuZmNhc3RfeXI7XHJcblxyXG4gICAgICAgIG1heCA9IHJvd3MucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGN1cnIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByZXYuZmNhc3RfeXIgPiBjdXJyLmZjYXN0X3lyID8gcHJldiA6IGN1cnI7XHJcbiAgICAgICAgfSkuZmNhc3RfeXI7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coXCJNaW4gXCIgKyBtaW4gKyBcIiBNYXggXCIgKyBtYXgpO1xyXG5cclxuXHJcbiAgICAvLy8vIEZpbmQgdGhlIG1pbiBhbmQgbWF4IHllYXJcclxuICAgIC8vdmFyIG1pbiA9IHJvd3MucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGN1cnIpIHtcclxuICAgIC8vICAgIHJldHVybiBwcmV2LmRpc2NfeXIgPCBjdXJyLmRpc2NfeXIgPyBwcmV2IDogY3VycjtcclxuICAgIC8vfSk7XHJcbiAgICAvL1xyXG4gICAgLy92YXIgbWF4ID0gcm93cy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY3Vycikge1xyXG4gICAgLy8gICAgcmV0dXJuIHByZXYuZGlzY195ciA+IGN1cnIuZGlzY195ciA/IHByZXYgOiBjdXJyO1xyXG4gICAgLy99KTtcclxuXHJcbiAgICAvL0NyZWF0ZSB0aGUgY29sdW1uc1xyXG4gICAgdmFyIHllYXJzID0gXCJcIjtcclxuXHJcbiAgICBmb3IodmFyIGkgPSBtaW47IGkgPD0gbWF4OyBpKyspe1xyXG4gICAgICAgIHllYXJzICs9IFwiPHRoPlwiICsgaSArIFwiPC90aD5cIjtcclxuICAgIH1cclxuXHJcbiAgICAkKCcjcmVzdWx0cy10YWJsZScpLmFwcGVuZCgnPHRyIGlkPVwiaGVhZC1yb3dcIj4gPHRoPkVEQjwvdGg+JysgeWVhcnMgKyAnPC90cj4nKTtcclxuXHJcblxyXG4gICAgLy8gQW4gYXJyYXkgb2YgY29tcGFuaWVzIGFscmVhZHkgcHJvY2Vzc2VkXHJcbiAgICB2YXIgZG9uZSA9IFtdO1xyXG4gICAgdmFyIGNlbGxDb3VudCA9IDA7XHJcblxyXG5cclxuICAgIHZhciBjZWxsVmFsdWVzID0gW107XHJcblxyXG4gICAgLy8gQ3JlYXRlIHRoZSByb3dzIG9mIGRhdGFcclxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCByb3dzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICBpZighZG9uZS5pbmNsdWRlcyhyb3dzW2ldLmVkYikpe1xyXG5cclxuICAgICAgICAgICAgZG9uZS5wdXNoKHJvd3NbaV0uZWRiKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEluc2VydCBuYW1lIGluIGNvbHVtbiBhbmQgYXNzaWduIGFuIGlkIHRvIHRoZSByb3dcclxuICAgICAgICAgICAgdmFyIHJvdyA9IFwiPHRyIGlkPXJvd1wiK2krXCI+PHRoPlwiICsgcm93c1tpXS5lZGIgKyBcIjwvdGg+XCI7XHJcblxyXG5cclxuICAgICAgICAgICAgZm9yKHZhciBjdXIgPSBtaW47IGN1ciA8PW1heDsgY3VyKyspe1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBhbGwgcm93cyBmaW5kaW5nIG9uZXMgd2l0aCB0aGUgY3VycmVudCBlZGJcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCByb3dzLmxlbmd0aDsgaisrKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaXQgbWF0Y2hlcyBlZGIgYW5kIHllYXIgaW5zZXJ0aW5nIGludG9cclxuICAgICAgICAgICAgICAgICAgICBpZihyb3dzW2pdLmVkYiA9PT0gcm93c1tpXS5lZGIgJiYgKG9ic2VydmVyZCA/IHJvd3Nbal0uZGlzY195ciA6IHJvd3Nbal0uZmNhc3RfeXIpID09PSBjdXIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3cgKz0gXCI8dGggaWQ9J3RcIitjZWxsQ291bnQrXCInPlwiICsgcm93c1tqXS52YWx1ZSArIFwiPC90aD5cIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNhdmUgdGhlIHZhbHVlIGFuZCB0aGUgaWQgb2YgdGhlIGNlbGwgdG8gZGlzcGxheSBwZXJjZW50YWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxWYWx1ZXMucHVzaCh7IGlkIDogXCIjdFwiK2NlbGxDb3VudCwgdmFsdWUgOiByb3dzW2pdLnZhbHVlIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbENvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkKCcjcmVzdWx0cy10YWJsZScpLmFwcGVuZChyb3cgKyAnPC90cj4nKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEFzc2luZyBhIG9uIGNsaWNrIGZ1bmN0aW9uIHRvIGVhY2ggb2YgdGhlIHJvd3MgdG8gZ2VuZXJhdGUgdGhlIGJhciBncmFwaCB3aXRoIHRoZSByb3cgc3BlY2lmaWMgZGF0YVxyXG4gICAgICAgICAgICAkKCBcIiNyb3dcIitpK1wiXCIpLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBzaG93QmFyV2l0aFJvd0VsZW0odGhpcy5pZCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIG1heCA9IC1JbmZpbml0eTtcclxuICAgIC8vIGFwbGx5cyBjc3MgdG8gZWFjaCBjZWxsXHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgY2VsbFZhbHVlcy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgIGlmKCtjZWxsVmFsdWVzW2ldLnZhbHVlID4gbWF4KXttYXggPSArY2VsbFZhbHVlc1tpXS52YWx1ZTt9XHJcbiAgICAgICAgJChjZWxsVmFsdWVzW2ldLmlkKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgXCJiYWNrZ3JvdW5kXCIgOiBcIi13ZWJraXQtZ3JhZGllbnQobGluZWFyLCBsZWZ0IHRvcCwgcmlnaHQgdG9wLCBjb2xvci1zdG9wKFwiICsgY2VsbFZhbHVlc1tpXS52YWx1ZSArXCIlLCNGMDApLCBjb2xvci1zdG9wKFwiICsgY2VsbFZhbHVlc1tpXS52YWx1ZSArXCIlLCNGRkYpKVwiLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuICAgIG1heFRhYmxlVmFsdWUgPSBtYXg7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dCYXJXaXRoUm93RWxlbShyb3dJRCl7XHJcbiAgICB2YXIgZGF0YSA9IFtdO1xyXG5cclxuICAgIC8vIHNldCB0aGUgcm93IHNlbGVjdGVkXHJcbiAgICAkKCcjcmVzdWx0cy10YWJsZScpLmZpbmQoJ3RyJykucmVtb3ZlQ2xhc3MoJ3Jvdy1zZWxlY3RlZCcpO1xyXG4gICAgJCgnIycrcm93SUQpLmFkZENsYXNzKCdyb3ctc2VsZWN0ZWQnKTtcclxuXHJcblxyXG4gICAgJCgnI2hlYWQtcm93JykuZmluZCgndGgnKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgIGlmKGluZGV4ICE9IDApeyAvLyAwIGlzIG5vdCBhIHllYXJcclxuICAgICAgICAgICAgZGF0YS5wdXNoKHtjYXRlZ29yeSA6ICQoZWxlbWVudCkudGV4dCgpLCB2YWx1ZSA6IDB9KTsgLy8gMCBpcyB0ZW1wXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHRpdGxlID0gXCJcIjtcclxuXHJcbiAgICAkKCcjJytyb3dJRCkuZmluZCgndGgnKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgIGlmKGluZGV4ICE9IDApe1xyXG4gICAgICAgICAgICBkYXRhW2luZGV4LTFdLnZhbHVlID0gJChlbGVtZW50KS50ZXh0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGl0bGUgPSBkYXRhW2luZGV4XS52YWx1ZSA9ICQoZWxlbWVudCkudGV4dCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgU2luZ2xlQmFyTW9kdWxlLmNyZWF0ZUJhckdyYXBoKFwiI2dyYXBoLWRpdlwiLCBtYXhUYWJsZVZhbHVlLCBkYXRhKTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGluc2VydENvbXBhbmllcygpe1xyXG4gICAgJC5nZXQoXCIvc2VjdGlvbnMvY29tcGFueVwiLCBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICBpZihkYXRhLmNvbXBhbmllcy5sZW5ndGggPiAwKXtcclxuICAgICAgICAgICAgJCgnI2NvbXBhbnktc2VsZWN0JykuaHRtbCgnPG9wdGlvbiBzZWxlY3RlZD4nICsgZGF0YS5jb21wYW5pZXNbMF0gKyAnPC9vcHRpb24+Jyk7IC8vIEVtcHR5IHRlbXAgb3B0aW9uc1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yKHZhciBpID0gMTsgaSA8IGRhdGEuY29tcGFuaWVzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgJCgnI2NvbXBhbnktc2VsZWN0JykuYXBwZW5kKCc8b3B0aW9uPicgKyBkYXRhLmNvbXBhbmllc1tpXSArICc8L29wdGlvbj4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJChcIi5zZWxlY3RwaWNrZXJcIikuc2VsZWN0cGlja2VyKCdyZWZyZXNoJyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcbi8vIE5ldyBwb3RlbnRpYWxseSBmb3IgY2hhbmdpbmcgdGhlIHVybCB3aGVuIHNlYXJjaCBpcyBjbGlja2VkXHJcbiJdfQ==
