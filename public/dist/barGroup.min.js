function GroupedBarData(t,e,a,r,n,i){this.x0=t,this.x1=e,this.y=a,this.yAxis=r,this.svg=n,this.id=i,this.created=!1}function highlight(t,e){d3.selectAll(".bar-selected").datum(function(t){return t}).attr("fill",function(t){return z(t.key)}),d3.selectAll(".bar-selected").classed("bar-selected",!1),e||d3.selectAll("rect."+t.replace(/ /g,"")).classed("bar-selected",!0).datum(function(t){return t}).attr("fill",function(t){return zSelected(t.key)})}function createdGroupedBarGraph(t,e,a,r){var n=null;barGraphs.forEach(function(t){t.id===r&&(n=t)}),null===n&&(n=new GroupedBarData(d3.scaleBand().rangeRound([0,width]).paddingInner(.05),d3.scaleBand().padding(.05),d3.scaleLinear().rangeRound([height,0]),d3.axisLeft(),d3.axisBottom(),r),barGraphs.push(n)),n.created||(n.svg=d3.select(r).append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")")),n.x0.domain(t.map(function(t){return t.edb})),n.x1.domain(e).rangeRound([0,n.x0.bandwidth()]),n.y.domain([0,d3.max(t,function(t){return d3.max(e,function(e){return Math.abs(t[e])})})]).nice();var i=n.svg.append("g").attr("transform","translate("+margin.left+","+margin.top+")"),s=d3.format(".2f"),l=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){return"<strong>Value:</strong> <span style='color:lightgreen'>"+s(t.value)+"</span><br><br><strong>Year:</strong> <span style='color:lightgreen'>"+t.key+"</span>"});n.svg.call(l),n.created?i.append("g").selectAll("g").data(t).attr("transform",function(t){return"translate("+n.x0(t.edb)+",0)"}).selectAll("rect").data(function(t){return e.map(function(e){return{neg:t[e]<0,key:e,value:Math.abs(t[e])}})}).enter().append("rect").attr("x",function(t){return n.x1(t.key)}).attr("y",function(t){return n.y(t.value)}).attr("width",n.x1.bandwidth()).attr("height",function(t){return height-n.y(t.value)}).attr("fill",function(t){return t.neg?zRed(t.key):z(t.key)}).on("mouseover",l.show).on("mouseout",l.hide):i.append("g").selectAll("g").data(t).enter().append("g").attr("transform",function(t){return"translate("+n.x0(t.edb)+",0)"}).selectAll("rect").data(function(t){return e.map(function(e){return{neg:t[e]<0,key:e,edb:t.edb,value:Math.abs(t[e])}})}).enter().append("rect").attr("x",function(t){return n.x1(t.key)}).attr("y",function(t){return n.y(t.value)}).attr("width",n.x1.bandwidth()).attr("height",function(t){return height-n.y(t.value)}).attr("fill",function(t){return t.neg?zRed(t.key):z(t.key)}).attr("class",function(t){return""+t.edb.replace(/ /g,"")}).on("mouseover",l.show).on("mouseout",l.hide),i.append("g").attr("class","axis").attr("transform","translate(0,"+height+")").call(d3.axisBottom(n.x0)).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").style("font-size","14px").attr("transform","rotate(55)").style("text-anchor","start"),n.created?n.svg.select(".yAxis").call(n.yAxis):i.append("g").attr("class","axis").attr("class","yAxis").call(n.yAxis.scale(n.y).ticks(null,"s")).append("text").attr("x",2).attr("y",n.y(n.y.ticks().pop())+.5).attr("dy","0.32em").attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start"),n.svg.append("text").attr("text-anchor","middle").attr("transform","translate("+(margin.left/2-35)+","+2*margin.top+")rotate(-90)").style("font-size","18px").attr("class","unit-text").text(a);var d=i.append("g").attr("font-family","sans-serif").attr("font-size",10).attr("text-anchor","end").selectAll("g").data(e.slice().reverse()).enter().append("g").attr("transform",function(t,e){return"translate(0,"+20*e+")"});d.append("rect").attr("x",width-100).attr("width",19).attr("height",19).attr("fill",z),d.append("text").attr("x",width-120).attr("y",9.5).attr("dy","0.32em").attr("class","g-text").style("font-size","14px").text(function(t){return t}),n.created=!0}var margin={top:35,right:85,bottom:150,left:50},width=1200-margin.left-margin.right,height=800-margin.top-margin.bottom,barGraphs=[],z=d3.scaleOrdinal().range(["#BBDEFB","#64B5F6","#1976D2","#1565C0","#0D47A1","#d0743c","#ff8c00"]),zRed=d3.scaleOrdinal().range(["#FF7373","#FF4C4C","#FF2626","#B20000","#D90000","#d0743c","#ff8c00"]),zSelected=d3.scaleOrdinal().range(["#C1FFC1","#90EE90","#5BC85B","#31A231","#137B13","#d0743c","#ff8c00"]);